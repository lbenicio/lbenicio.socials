function $(e,t=document){return t.querySelector(e)}function $all(e,t=document){return Array.from(t.querySelectorAll(e))}let scriptEl=document.currentScript;scriptEl||(scriptEl=document.querySelector('script[type="module"][data-index-url]')),scriptEl||(scriptEl=document.querySelector('script[type="module"][src*="search"]'));const indexUrl=scriptEl?.getAttribute('data-df0ff22')||"/blog/index.json",input=$("#icf1de4")||$("#ic25140"),status=$("#i798ea7")||$("#ie7e883"),tagsWrap=$("#i7398b5")||$("#id6318a"),serverList=$("#i3d0710")||$("#i3259bf");let INDEX=[],TAGS=new Map,ACTIVE_TAGS=new Set,loaded=!1;function sanitize(e){return(e||"").toString().toLowerCase()}function scoreEntry(e,t){const s=sanitize(e);if(!s&&ACTIVE_TAGS.size===0)return 1;let n=0;const o=sanitize(t.title).includes(s),i=sanitize(t.description).includes(s),a=(t.tags||[]).some(e=>sanitize(e).includes(s));if(o&&(n+=5),i&&(n+=2),a&&(n+=1),ACTIVE_TAGS.size>0){const e=[...ACTIVE_TAGS].every(e=>(t.tags||[]).map(sanitize).includes(sanitize(e)));if(!e)return 0;n+=3}return n}function renderTags(){if(!tagsWrap)return;tagsWrap.innerHTML="";const e=[...TAGS.entries()].sort((e,t)=>t[1]-e[1]).slice(0,25);for(const[t,s]of e){const n=document.createElement("button");n.type="button",n.className="inline-flex items-center gap-1 rounded-full border px-2 py-1 hover:bg-accent transition-colors "+(ACTIVE_TAGS.has(t)?"bg-accent":""),n.setAttribute("aria-pressed",ACTIVE_TAGS.has(t)?"true":"false"),n.textContent=`${t} (${s})`,n.addEventListener("click",()=>{ACTIVE_TAGS.has(t)?ACTIVE_TAGS.delete(t):ACTIVE_TAGS.add(t),n.setAttribute("aria-pressed",ACTIVE_TAGS.has(t)?"true":"false"),update()}),tagsWrap.appendChild(n)}}function getGridClassName(){if(!serverList)return"grid gap-6 sm:grid-cols-2 lg:grid-cols-3";const e=serverList.querySelector('ul'),t=(e?.className||serverList.className||"").trim();return t||"grid gap-6 sm:grid-cols-2 lg:grid-cols-3"}function renderResults(e){if(!serverList)return;const n=(input?.value?.trim()?.length||0)>0||ACTIVE_TAGS.size>0;serverList.style.display=n?"none":"";let t=$("#i0884ba")||$("#i314f20");if(!n){t&&t.remove(),status&&(status.textContent="");return}t||(t=document.createElement("ul"),t.id="i0884ba",t.className=getGridClassName(),serverList.insertAdjacentElement("afterend",t)),t.innerHTML=e.map(e=>{const s=e.year||(e.date?String(e.date).slice(0,4):""),t=[];e.author&&t.push(e.author),e.venue&&t.push(e.venue);const n=t.join(" • "),o=(e.tags||[]).map(e=>`<span class="inline-flex items-center rounded-full border px-2 py-0.5 text-xs">${e}</span>`).join(" ");return`
      <li class="border rounded-lg overflow-hidden flex flex-col transition-colors"> 
        ${e.cover?`<a href="${e.link}" class="block aspect-[16/9] bg-muted"><img src="${e.cover}" alt="" class="w-full h-full object-cover" /></a>`:""}
        <a href="${e.link}" class="p-4 flex-1 hover:bg-accent/30 transition-colors">
        <h3 class="font-semibold line-clamp-2">${e.title}</h3>
        ${n?`<div class="text-xs text-muted-foreground mt-1">${n}</div>`:""}
        <p class="text-sm text-muted-foreground mt-1 line-clamp-2">${e.description||""}</p>
        <div class="text-xs text-muted-foreground mt-2">${s}</div>
        <div class="flex gap-2 flex-wrap mt-2">
          ${o}
        </div>
      </a>
    </li>`}).join("")}function update(){if(!loaded)return;const e=input?.value||"",t=INDEX.map(t=>({e:t,s:scoreEntry(e,t)})).filter(e=>e.s>0).sort((e,t)=>t.s-e.s||String(t.e.date).localeCompare(String(e.e.date))).slice(0,60).map(e=>e.e);renderResults(t);const n=t.length;status&&(status.textContent=`${n} result${n===1?"":"s"}${e?` for "${e}"`:""}${ACTIVE_TAGS.size?` · filters: ${[...ACTIVE_TAGS].join(", ")}`:""}`)}async function boot(){try{const e=await fetch(indexUrl,{headers:{accept:"application/json"}});if(!e.ok)throw new Error(`Failed to load index: ${e.status}`);INDEX=await e.json();for(const e of INDEX)for(const n of e.tags||[]){const t=sanitize(n);TAGS.set(t,(TAGS.get(t)||0)+1)}loaded=!0,renderTags(),update()}catch(e){status&&(status.textContent="Search unavailable."),console.error(e)}}function runSearchScript(){input&&(input.addEventListener("input",update),window.addEventListener("keydown",e=>{if(e.key==="/"&&!e.metaKey&&!e.ctrlKey&&!e.altKey){const t=e.target,n=t&&(t.tagName==="INPUT"||t.tagName==="TEXTAREA"||t.isContentEditable);n||(e.preventDefault(),input.focus())}})),boot()}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",runSearchScript):runSearchScript()